<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Fragments.Rec</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--safe</a> <a id="20" class="Pragma">--without-K</a> <a id="32" class="Symbol">#-}</a>

<a id="37" class="Keyword">module</a> <a id="44" href="Fragments.Rec.html" class="Module">Fragments.Rec</a> <a id="58" class="Keyword">where</a>

<a id="65" class="Keyword">open</a> <a id="70" class="Keyword">import</a> <a id="77" href="Signature.html" class="Module">Signature</a>
<a id="87" class="Keyword">open</a> <a id="92" class="Keyword">import</a> <a id="99" href="Canon.html" class="Module">Canon</a>
<a id="105" class="Keyword">open</a> <a id="110" class="Keyword">import</a> <a id="117" href="MonadicFragment.html" class="Module">MonadicFragment</a>

<a id="134" class="Keyword">open</a> <a id="139" class="Keyword">import</a> <a id="146" href="Data.Product.html" class="Module">Data.Product</a>
<a id="159" class="Keyword">open</a> <a id="164" class="Keyword">import</a> <a id="171" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="180" class="Keyword">open</a> <a id="185" class="Keyword">import</a> <a id="192" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="201" class="Keyword">hiding</a> <a id="208" class="Symbol">(</a><a id="209" href="Data.Vec.Base.html#4317" class="Function Operator">_&gt;&gt;=_</a> <a id="215" class="Symbol">;</a> <a id="217" href="Data.Vec.Base.html#1566" class="Function">lookup</a><a id="223" class="Symbol">)</a>
<a id="225" class="Keyword">open</a> <a id="230" class="Keyword">import</a> <a id="237" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="248" class="Keyword">hiding</a> <a id="255" class="Symbol">(</a><a id="256" href="Data.Maybe.Base.html#2246" class="Function Operator">_&gt;&gt;=_</a><a id="261" class="Symbol">)</a>
<a id="263" class="Keyword">open</a> <a id="268" class="Keyword">import</a> <a id="275" href="Data.List.html" class="Module">Data.List</a> <a id="285" class="Keyword">hiding</a> <a id="292" class="Symbol">(</a><a id="293" href="Data.List.Base.html#5816" class="Function">lookup</a><a id="299" class="Symbol">)</a>
<a id="301" class="Keyword">open</a> <a id="306" class="Keyword">import</a> <a id="313" href="Data.List.Membership.Propositional.html" class="Module">Data.List.Membership.Propositional</a>
<a id="348" class="Keyword">open</a> <a id="353" class="Keyword">import</a> <a id="360" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a>


<a id="391" class="Keyword">open</a> <a id="396" class="Keyword">import</a> <a id="403" href="Function.html" class="Module">Function</a>
<a id="412" class="Keyword">import</a>      <a id="424" href="Level.html" class="Module">Level</a>    <a id="433" class="Symbol">as</a> <a id="436" class="Module">L</a>

<a id="439" class="Keyword">module</a> <a id="446" href="Fragments.Rec.html#446" class="Module">_</a> <a id="448" class="Keyword">where</a>

  <a id="457" class="Keyword">open</a> <a id="462" class="Keyword">import</a> <a id="469" href="Fragments.Lambda.html" class="Module">Fragments.Lambda</a> <a id="486" class="Keyword">using</a> <a id="492" class="Symbol">(</a><a id="493" href="Fragments.Lambda.html#485" class="Function">FunTyΣ</a> <a id="500" class="Symbol">;</a> <a id="502" href="Fragments.Lambda.html#619" class="Function">FunVal</a> <a id="509" class="Symbol">;</a> <a id="511" href="Fragments.Lambda.html#528" class="Function">`fun</a><a id="515" class="Symbol">)</a>

  <a id="520" class="Keyword">data</a> <a id="525" href="Fragments.Rec.html#525" class="Datatype">RecFunExprShape</a> <a id="541" class="Symbol">{</a><a id="542" href="Fragments.Rec.html#542" class="Bound">σ</a><a id="543" class="Symbol">}</a> <a id="545" class="Symbol">⦃</a> <a id="547" href="Fragments.Rec.html#547" class="Bound">_</a> <a id="549" class="Symbol">:</a> <a id="551" href="Fragments.Lambda.html#485" class="Function">FunTyΣ</a> <a id="558" href="Signature.html#4225" class="Record Operator">≼</a> <a id="560" href="Fragments.Rec.html#542" class="Bound">σ</a> <a id="562" class="Symbol">⦄</a> <a id="564" class="Symbol">:</a> <a id="566" href="MonadicFragment.html#614" class="Function">withContext</a> <a id="578" class="Symbol">(</a><a id="579" href="Signature.html#1249" class="Datatype">μ</a> <a id="581" href="Fragments.Rec.html#542" class="Bound">σ</a><a id="582" class="Symbol">)</a> <a id="584" class="Symbol">→</a> <a id="586" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="590" class="Keyword">where</a>
    <a id="600" href="Fragments.Rec.html#600" class="InductiveConstructor">fix</a> <a id="604" class="Symbol">:</a> <a id="606" class="Symbol">∀</a> <a id="608" class="Symbol">{</a><a id="609" href="Fragments.Rec.html#609" class="Bound">Γ</a> <a id="611" href="Fragments.Rec.html#611" class="Bound">s</a> <a id="613" href="Fragments.Rec.html#613" class="Bound">t</a><a id="614" class="Symbol">}</a> <a id="616" class="Symbol">→</a> <a id="618" href="Fragments.Rec.html#525" class="Datatype">RecFunExprShape</a> <a id="634" class="Symbol">(</a><a id="635" href="Fragments.Rec.html#609" class="Bound">Γ</a> <a id="637" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="639" href="Fragments.Lambda.html#528" class="Function">`fun</a> <a id="644" href="Fragments.Rec.html#611" class="Bound">s</a> <a id="646" href="Fragments.Rec.html#613" class="Bound">t</a><a id="647" class="Symbol">)</a> 

  <a id="653" href="Fragments.Rec.html#653" class="Function">RecFunExprΣ</a> <a id="665" class="Symbol">:</a> <a id="667" class="Symbol">⦃</a> <a id="669" href="Fragments.Rec.html#669" class="Bound">_</a> <a id="671" class="Symbol">:</a> <a id="673" href="Fragments.Lambda.html#485" class="Function">FunTyΣ</a> <a id="680" href="Signature.html#4225" class="Record Operator">≼</a> <a id="682" href="Signature.html#970" class="Generalizable">σ</a> <a id="684" class="Symbol">⦄</a> <a id="686" class="Symbol">→</a>  <a id="689" href="Signature.html#2411" class="Record">ISignature</a> <a id="700" class="Symbol">_</a> <a id="702" class="Symbol">(</a><a id="703" href="MonadicFragment.html#614" class="Function">withContext</a> <a id="715" class="Symbol">(</a><a id="716" href="Signature.html#1249" class="Datatype">μ</a> <a id="718" href="Signature.html#970" class="Generalizable">σ</a><a id="719" class="Symbol">))</a>
  <a id="724" href="Fragments.Rec.html#653" class="Function">RecFunExprΣ</a> <a id="736" class="Symbol">=</a> <a id="738" href="Fragments.Rec.html#525" class="Datatype">RecFunExprShape</a> <a id="754" href="Signature.html#2476" class="InductiveConstructor Operator">▸</a> <a id="756" class="Symbol">λ</a> <a id="758" class="Keyword">where</a>
    <a id="768" class="Symbol">(</a><a id="769" href="Fragments.Rec.html#600" class="InductiveConstructor">fix</a> <a id="773" class="Symbol">{</a><a id="774" href="Fragments.Rec.html#774" class="Bound">Γ</a><a id="775" class="Symbol">}</a> <a id="777" class="Symbol">{</a><a id="778" href="Fragments.Rec.html#778" class="Bound">s</a><a id="779" class="Symbol">}</a> <a id="781" class="Symbol">{</a><a id="782" href="Fragments.Rec.html#782" class="Bound">t</a><a id="783" class="Symbol">})</a> <a id="786" class="Symbol">→</a> <a id="788" class="Symbol">(</a><a id="789" href="Fragments.Rec.html#778" class="Bound">s</a> <a id="791" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="793" href="Fragments.Lambda.html#528" class="Function">`fun</a> <a id="798" href="Fragments.Rec.html#778" class="Bound">s</a> <a id="800" href="Fragments.Rec.html#782" class="Bound">t</a> <a id="802" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="804" href="Fragments.Rec.html#774" class="Bound">Γ</a> <a id="806" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="808" href="Fragments.Rec.html#782" class="Bound">t</a><a id="809" class="Symbol">)</a> <a id="811" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="813" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

  <a id="819" href="Fragments.Rec.html#819" class="Function">mfix</a> <a id="824" class="Symbol">:</a> <a id="826" class="Symbol">((</a><a id="828" href="Signature.html#481" class="Generalizable">A</a> <a id="830" class="Symbol">→</a> <a id="832" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="838" href="Signature.html#500" class="Generalizable">B</a><a id="839" class="Symbol">)</a> <a id="841" class="Symbol">→</a> <a id="843" href="Signature.html#481" class="Generalizable">A</a> <a id="845" class="Symbol">→</a> <a id="847" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="853" href="Signature.html#500" class="Generalizable">B</a><a id="854" class="Symbol">)</a> <a id="856" class="Symbol">→</a> <a id="858" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="860" class="Symbol">→</a> <a id="862" href="Signature.html#481" class="Generalizable">A</a> <a id="864" class="Symbol">→</a> <a id="866" href="Data.Maybe.Base.html#838" class="Datatype">Maybe</a> <a id="872" href="Signature.html#500" class="Generalizable">B</a>
  <a id="876" href="Fragments.Rec.html#819" class="Function">mfix</a> <a id="881" href="Fragments.Rec.html#881" class="Bound">f</a> <a id="883" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="888" class="Symbol">_</a>  <a id="891" class="Symbol">=</a> <a id="893" href="Data.Maybe.Base.html#872" class="InductiveConstructor">nothing</a>
  <a id="903" href="Fragments.Rec.html#819" class="Function">mfix</a> <a id="908" href="Fragments.Rec.html#908" class="Bound">f</a> <a id="910" class="Symbol">(</a><a id="911" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="915" href="Fragments.Rec.html#915" class="Bound">n</a><a id="916" class="Symbol">)</a> <a id="918" class="Symbol">=</a> <a id="920" href="Fragments.Rec.html#908" class="Bound">f</a> <a id="922" class="Symbol">(</a><a id="923" href="Fragments.Rec.html#819" class="Function">mfix</a> <a id="928" href="Fragments.Rec.html#908" class="Bound">f</a> <a id="930" href="Fragments.Rec.html#915" class="Bound">n</a><a id="931" class="Symbol">)</a>

  <a id="936" class="Keyword">open</a> <a id="941" href="MonadicFragment.html#1435" class="Module">Monadic</a> <a id="949" class="Symbol">⦃...⦄</a>
  <a id="957" class="Keyword">open</a> <a id="962" href="Signature.html#3423" class="Module">IAlgebra</a>
  <a id="973" href="Fragments.Rec.html#973" class="Function">interpRecFunAlg</a> <a id="989" class="Symbol">:</a> <a id="991" class="Symbol">⦃</a> <a id="993" href="Fragments.Rec.html#993" class="Bound">_</a> <a id="995" class="Symbol">:</a> <a id="997" href="Fragments.Lambda.html#619" class="Function">FunVal</a> <a id="1004" href="Canon.html#1225" class="Record Operator">⊆</a> <a id="1006" href="Signature.html#1808" class="Generalizable">V</a> <a id="1008" class="Symbol">⦄</a> <a id="1010" class="Symbol">→</a> <a id="1012" href="Signature.html#3423" class="Record">IAlgebra</a> <a id="1021" href="Fragments.Rec.html#653" class="Function">RecFunExprΣ</a> <a id="1033" class="Symbol">(</a><a id="1034" href="MonadicFragment.html#670" class="Function">withEff</a> <a id="1042" href="MonadicFragment.html#3945" class="Function">Reader</a> <a id="1049" class="Symbol">(</a><a id="1050" href="Signature.html#1998" class="Function">fold</a> <a id="1055" href="Signature.html#1808" class="Generalizable">V</a><a id="1056" class="Symbol">))</a>
  <a id="1061" href="Signature.html#3493" class="Field">ialg</a> <a id="1066" class="Symbol">(</a><a id="1067" href="Fragments.Rec.html#973" class="Function">interpRecFunAlg</a><a id="1082" class="Symbol">)</a> <a id="1084" class="Symbol">(</a><a id="1085" href="Fragments.Rec.html#600" class="InductiveConstructor">fix</a> <a id="1089" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1091" href="Level.html#457" class="InductiveConstructor">L.lift</a> <a id="1098" class="Symbol">(</a><a id="1099" href="Fragments.Rec.html#1099" class="Bound">fx</a> <a id="1102" href="Data.List.Relation.Unary.All.html#1477" class="InductiveConstructor Operator">∷</a> <a id="1104" href="Data.List.Relation.Unary.All.html#1460" class="InductiveConstructor">[]</a><a id="1106" class="Symbol">))</a> <a id="1109" class="Symbol">=</a> <a id="1111" class="Keyword">do</a>
    <a id="1118" href="Fragments.Rec.html#1118" class="Bound">nv</a> <a id="1121" href="MonadicFragment.html#1531" class="Field Operator">←</a> <a id="1123" href="MonadicFragment.html#4203" class="Function">ask</a>
    <a id="1131" href="Fragments.Rec.html#1131" class="Bound">n</a>  <a id="1134" href="MonadicFragment.html#1531" class="Field Operator">←</a> <a id="1136" href="MonadicFragment.html#4389" class="Function">remaining</a> 
    <a id="1151" href="MonadicFragment.html#1476" class="Field">return</a> <a id="1158" class="Symbol">(</a><a id="1159" href="Canon.html#5663" class="Function">↑</a> <a id="1161" class="Symbol">(</a><a id="1162" href="Fragments.Rec.html#819" class="Function">mfix</a> <a id="1167" class="Symbol">(λ</a> <a id="1170" href="Fragments.Rec.html#1170" class="Bound">μ</a> <a id="1172" href="Fragments.Rec.html#1172" class="Bound">x</a> <a id="1174" class="Symbol">→</a> <a id="1176" href="Fragments.Rec.html#1099" class="Bound">fx</a> <a id="1179" href="Fragments.Rec.html#1131" class="Bound">n</a> <a id="1181" class="Symbol">(</a><a id="1182" href="Fragments.Rec.html#1172" class="Bound">x</a> <a id="1184" href="Data.List.Relation.Unary.All.html#1477" class="InductiveConstructor Operator">∷</a> <a id="1186" href="Canon.html#5663" class="Function">↑</a> <a id="1188" href="Fragments.Rec.html#1170" class="Bound">μ</a> <a id="1190" href="Data.List.Relation.Unary.All.html#1477" class="InductiveConstructor Operator">∷</a> <a id="1192" href="Fragments.Rec.html#1118" class="Bound">nv</a><a id="1194" class="Symbol">))</a> <a id="1197" href="Fragments.Rec.html#1131" class="Bound">n</a><a id="1198" class="Symbol">))</a>

  <a id="1204" href="Fragments.Rec.html#1204" class="Function">frag</a> <a id="1209" class="Symbol">=</a> <a id="1211" href="MonadicFragment.html#1054" class="Function">mkfragmentM</a> <a id="1223" href="MonadicFragment.html#3945" class="Function">Reader</a> <a id="1230" href="Fragments.Rec.html#973" class="Function">interpRecFunAlg</a>
</pre></body></html>